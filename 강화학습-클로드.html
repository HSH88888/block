
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê°•í™”í•™ìŠµ Grid World ì‹œë®¬ë ˆì´ì…˜</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            margin: 0;
        }

        .container {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
            max-width: 800px;
        }

        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 10px;
        }

        .subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 20px;
        }

        #grid {
            display: grid;
            gap: 2px;
            background: #333;
            padding: 2px;
            margin: 20px auto;
            border-radius: 8px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .cell {
            width: 60px;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            background: white;
            transition: all 0.3s;
            position: relative;
        }

        .cell.agent {
            background: #4CAF50;
            color: white;
        }

        .cell.goal {
            background: #FFD700;
        }

        .cell.obstacle {
            background: #f44336;
        }

        .cell.visited {
            background: #E3F2FD;
        }

        .controls {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        button {
            padding: 12px 24px;
            font-size: 16px;
            cursor: pointer;
            border: none;
            border-radius: 6px;
            background: #667eea;
            color: white;
            transition: all 0.3s;
            font-weight: 600;
        }

        button:hover {
            background: #5568d3;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }

        button:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .stat-box {
            background: #f5f5f5;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
        }

        .stat-label {
            color: #666;
            font-size: 14px;
            margin-bottom: 5px;
        }

        .stat-value {
            color: #333;
            font-size: 24px;
            font-weight: bold;
        }

        .info {
            background: #e3f2fd;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            border-left: 4px solid #2196F3;
        }

        .legend {
            display: flex;
            gap: 20px;
            justify-content: center;
            margin: 15px 0;
            flex-wrap: wrap;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .legend-box {
            width: 30px;
            height: 30px;
            border-radius: 4px;
            border: 2px solid #333;
        }

        .speed-control {
            display: flex;
            align-items: center;
            gap: 10px;
            justify-content: center;
            margin: 15px 0;
        }

        input[type="range"] {
            width: 200px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ¤– ê°•í™”í•™ìŠµ Grid World</h1>
        <p class="subtitle">Q-Learning ì•Œê³ ë¦¬ì¦˜ìœ¼ë¡œ ì—ì´ì „íŠ¸ê°€ ëª©í‘œë¥¼ ì°¾ëŠ” ê³¼ì •ì„ ì‹œë®¬ë ˆì´ì…˜í•©ë‹ˆë‹¤</p>

        <div class="legend">
            <div class="legend-item">
                <div class="legend-box" style="background: #4CAF50;"></div>
                <span>ì—ì´ì „íŠ¸</span>
            </div>
            <div class="legend-item">
                <div class="legend-box" style="background: #FFD700;"></div>
                <span>ëª©í‘œ</span>
            </div>
            <div class="legend-item">
                <div class="legend-box" style="background: #f44336;"></div>
                <span>ì¥ì• ë¬¼</span>
            </div>
            <div class="legend-item">
                <div class="legend-box" style="background: #E3F2FD;"></div>
                <span>ë°©ë¬¸ ê²½ë¡œ</span>
            </div>
        </div>

        <div id="grid"></div>

        <div class="stats">
            <div class="stat-box">
                <div class="stat-label">ì—í”¼ì†Œë“œ</div>
                <div class="stat-value" id="episode">0</div>
            </div>
            <div class="stat-box">
                <div class="stat-label">ìŠ¤í…</div>
                <div class="stat-value" id="steps">0</div>
            </div>
            <div class="stat-box">
                <div class="stat-label">ì´ ë³´ìƒ</div>
                <div class="stat-value" id="reward">0</div>
            </div>
            <div class="stat-box">
                <div class="stat-label">ì„±ê³µë¥ </div>
                <div class="stat-value" id="success">0%</div>
            </div>
        </div>

        <div class="speed-control">
            <label for="speed">í•™ìŠµ ì†ë„:</label>
            <input type="range" id="speed" min="1" max="100" value="50">
            <span id="speedValue">50ms</span>
        </div>

        <div class="controls">
            <button id="trainBtn" onclick="startTraining()">ğŸ“ í•™ìŠµ ì‹œì‘</button>
            <button id="stopBtn" onclick="stopTraining()" disabled>â¸ï¸ ì¼ì‹œì •ì§€</button>
            <button id="resetBtn" onclick="resetEnvironment()">ğŸ”„ ì´ˆê¸°í™”</button>
            <button id="testBtn" onclick="testAgent()">ğŸ¯ í…ŒìŠ¤íŠ¸ ì‹¤í–‰</button>
        </div>

        <div class="info">
            <strong>ğŸ“š ì‘ë™ ì›ë¦¬:</strong><br>
            â€¢ <strong>Q-Learning</strong>: ì—ì´ì „íŠ¸ê°€ ìƒíƒœ-í–‰ë™ ê°€ì¹˜ë¥¼ í•™ìŠµí•©ë‹ˆë‹¤<br>
            â€¢ <strong>íƒí—˜ vs í™œìš©</strong>: Îµ-greedy ì „ëµìœ¼ë¡œ ìƒˆë¡œìš´ ê²½ë¡œë¥¼ íƒìƒ‰í•˜ê±°ë‚˜ í•™ìŠµí•œ ì§€ì‹ì„ í™œìš©í•©ë‹ˆë‹¤<br>
            â€¢ <strong>ë³´ìƒ ì‹œìŠ¤í…œ</strong>: ëª©í‘œ ë„ë‹¬ ì‹œ +100, ì¥ì• ë¬¼ -100, ê° ìŠ¤í…ë§ˆë‹¤ -1<br>
            â€¢ <strong>í•™ìŠµë¥ (Î±)</strong>: 0.1, <strong>í• ì¸ìœ¨(Î³)</strong>: 0.9, <strong>íƒí—˜ìœ¨(Îµ)</strong>: 0.1
        </div>
    </div>

    <script>
        const GRID_SIZE = 6;
        const ACTIONS = ['up', 'down', 'left', 'right'];

        let qTable = {};
        let agent = { x: 0, y: 0 };
        let goal = { x: 5, y: 5 };
        let obstacles = [
            { x: 1, y: 1 }, { x: 2, y: 2 }, { x: 3, y: 1 },
            { x: 1, y: 3 }, { x: 4, y: 3 }
        ];

        let episode = 0;
        let steps = 0;
        let totalReward = 0;
        let successCount = 0;
        let isTraining = false;
        let trainingInterval = null;
        let visitedCells = new Set();

        const alpha = 0.1;    // í•™ìŠµë¥ 
        const gamma = 0.9;    // í• ì¸ìœ¨
        let epsilon = 0.1;    // íƒí—˜ìœ¨

        function initGrid() {
            const grid = document.getElementById('grid');
            grid.style.gridTemplateColumns = `repeat(${GRID_SIZE}, 60px)`;
            grid.innerHTML = '';

            for (let y = 0; y < GRID_SIZE; y++) {
                for (let x = 0; x < GRID_SIZE; x++) {
                    const cell = document.createElement('div');
                    cell.className = 'cell';
                    cell.id = `cell-${x}-${y}`;

                    if (x === agent.x && y === agent.y) {
                        cell.classList.add('agent');
                        cell.textContent = 'ğŸ¤–';
                    } else if (x === goal.x && y === goal.y) {
                        cell.classList.add('goal');
                        cell.textContent = 'ğŸ¯';
                    } else if (obstacles.some(obs => obs.x === x && obs.y === y)) {
                        cell.classList.add('obstacle');
                        cell.textContent = 'ğŸš«';
                    }

                    grid.appendChild(cell);
                }
            }
        }

        function getStateKey(x, y) {
            return `${x},${y}`;
        }

        function getQValue(state, action) {
            const key = `${state}-${action}`;
            return qTable[key] || 0;
        }

        function setQValue(state, action, value) {
            const key = `${state}-${action}`;
            qTable[key] = value;
        }

        function chooseAction(state) {
            if (Math.random() < epsilon) {
                return ACTIONS[Math.floor(Math.random() * ACTIONS.length)];
            }

            let bestAction = ACTIONS[0];
            let bestValue = getQValue(state, bestAction);

            for (let action of ACTIONS) {
                const value = getQValue(state, action);
                if (value > bestValue) {
                    bestValue = value;
                    bestAction = action;
                }
            }

            return bestAction;
        }

        function takeAction(action) {
            let newX = agent.x;
            let newY = agent.y;

            switch(action) {
                case 'up': newY = Math.max(0, newY - 1); break;
                case 'down': newY = Math.min(GRID_SIZE - 1, newY + 1); break;
                case 'left': newX = Math.max(0, newX - 1); break;
                case 'right': newX = Math.min(GRID_SIZE - 1, newX + 1); break;
            }

            let reward = -1;
            let done = false;

            if (obstacles.some(obs => obs.x === newX && obs.y === newY)) {
                reward = -100;
                done = true;
            } else if (newX === goal.x && newY === goal.y) {
                reward = 100;
                done = true;
                successCount++;
            } else {
                agent.x = newX;
                agent.y = newY;
                visitedCells.add(getStateKey(newX, newY));
            }

            return { newX, newY, reward, done };
        }

        function updateQValue(state, action, reward, nextState) {
            const currentQ = getQValue(state, action);

            let maxNextQ = -Infinity;
            for (let nextAction of ACTIONS) {
                const q = getQValue(nextState, nextAction);
                if (q > maxNextQ) maxNextQ = q;
            }

            const newQ = currentQ + alpha * (reward + gamma * maxNextQ - currentQ);
            setQValue(state, action, newQ);
        }

        function updateDisplay() {
            for (let y = 0; y < GRID_SIZE; y++) {
                for (let x = 0; x < GRID_SIZE; x++) {
                    const cell = document.getElementById(`cell-${x}-${y}`);
                    cell.className = 'cell';
                    cell.textContent = '';

                    if (visitedCells.has(getStateKey(x, y))) {
                        cell.classList.add('visited');
                    }

                    if (x === agent.x && y === agent.y) {
                        cell.classList.add('agent');
                        cell.textContent = 'ğŸ¤–';
                    } else if (x === goal.x && y === goal.y) {
                        cell.classList.add('goal');
                        cell.textContent = 'ğŸ¯';
                    } else if (obstacles.some(obs => obs.x === x && obs.y === y)) {
                        cell.classList.add('obstacle');
                        cell.textContent = 'ğŸš«';
                    }
                }
            }

            document.getElementById('episode').textContent = episode;
            document.getElementById('steps').textContent = steps;
            document.getElementById('reward').textContent = Math.round(totalReward);
            const successRate = episode > 0 ? Math.round((successCount / episode) * 100) : 0;
            document.getElementById('success').textContent = successRate + '%';
        }

        function runEpisode() {
            agent.x = 0;
            agent.y = 0;
            visitedCells.clear();
            visitedCells.add(getStateKey(0, 0));

            let episodeSteps = 0;
            let episodeReward = 0;
            const maxSteps = 100;

            const stepInterval = setInterval(() => {
                const state = getStateKey(agent.x, agent.y);
                const action = chooseAction(state);
                const result = takeAction(action);

                episodeSteps++;
                steps++;
                episodeReward += result.reward;
                totalReward += result.reward;

                const nextState = getStateKey(result.newX, result.newY);
                updateQValue(state, action, result.reward, nextState);

                updateDisplay();

                if (result.done || episodeSteps >= maxSteps) {
                    clearInterval(stepInterval);
                    episode++;

                    if (isTraining) {
                        setTimeout(runEpisode, 100);
                    }
                }
            }, 101 - document.getElementById('speed').value);

            if (!isTraining) {
                clearInterval(stepInterval);
            }
        }

        function startTraining() {
            isTraining = true;
            document.getElementById('trainBtn').disabled = true;
            document.getElementById('stopBtn').disabled = false;
            document.getElementById('testBtn').disabled = true;
            epsilon = 0.1;
            runEpisode();
        }

        function stopTraining() {
            isTraining = false;
            document.getElementById('trainBtn').disabled = false;
            document.getElementById('stopBtn').disabled = true;
            document.getElementById('testBtn').disabled = false;
        }

        function resetEnvironment() {
            stopTraining();
            qTable = {};
            agent = { x: 0, y: 0 };
            episode = 0;
            steps = 0;
            totalReward = 0;
            successCount = 0;
            visitedCells.clear();
            visitedCells.add(getStateKey(0, 0));
            initGrid();
            updateDisplay();
        }

        function testAgent() {
            epsilon = 0;
            agent.x = 0;
            agent.y = 0;
            visitedCells.clear();
            runEpisode();
        }

        document.getElementById('speed').addEventListener('input', (e) => {
            document.getElementById('speedValue').textContent = (101 - e.target.value) + 'ms';
        });

        initGrid();
        updateDisplay();
    </script>
</body>
</html>